# Script to prepare .tsv file for blast of candidates
# Janina Rinke, 21.06.2021

```{r}
library(ggplot2)
library(data.table)
library(dplyr)
library(tidyr)
```

Load the file with all good candidates from Excel 
```{r}
# data <- GAGA_LGT_162_filtered_good_candidates

# newly filtered candidates, only the newly detected good candidates (21 additional candidates compared to the old dataset)
new_candidates <- GAGA_LGT_162_new_filtered_evaluated
```

# Keep only the columns you are interested in from the dataframe
```{r}
new_candidates %>%
  select(.id, cand.scaffold, cand.start.x, cand.end.x)
```

### Get only one candidate per row 

Possibility 1: Split the columns with several candidates to only contain one candidate per row
```{r}
head(new_candidates)
new_df <- new_candidates %>% separate_rows(cand.start.x,cand.end.x) #separate, if several values exist in one column
head(new_df)
```

Possibility 2: Take the smallest value from the column cand.start and the highest value from the cand.end column
```{r}
#new_data <- new_candidates$start + 20000
new_data2 <- new_candidates$end - 20000

#data$start <- new_data
new_candidates$end <- new_data2
```

```{r}
new_df <- new_candidates %>%
  select(.id, cand.scaffold, start, end)
```

### Keep only the GAGA-id
```{r}
data2 <- sapply(strsplit(new_df$.id, "[.]"), "[", 1)
new_df$.id <- data2
new_df <- new_df[-c(8, 12), ] # rows with negative end coordinates removed
```

### Save file as tsv file 
```{r}
write.table(new_df,"/Users/Janina/sciebo/Master.LGTs/blastNewCandidates.tsv",sep="\t",quote = F,row.names = F, col.names = F)
```
