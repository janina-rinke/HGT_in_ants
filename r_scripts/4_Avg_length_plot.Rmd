# Script to plot average length of good candidates 

```{r}
library(ggplot2)
library(data.table)
library(dplyr)
library(tidyr)
#install.packages("tidyverse")
library(tidyverse)
library(export)
```

# Load the file with all good candidates from Excel
```{r}
df <- GAGA_LGT_162_filtered_good_candidates_taxonomy
head(df)
```

# Split the candidate regions into single candidates
```{r}
new_df <- separate_rows(df, cand.start, cand.end, convert = T)
```


# add column with length of candidate

```{r}
new_df$cand.length<-new_df$cand.end-new_df$cand.start
```

# remove everything from GAGA-0200 to exclude the large region with the whole Blochmannia genome
```{r}
dfnoGAGA200 <-subset(new_df, .id != "GAGA-0200.euk")
```

# plot overview plots
plot histogram of length to see how the candidates are distributed
```{r}
# length of candidate
p0 <- ggplot(dfnoGAGA200, aes(x=cand.length)) +
  geom_histogram(color="black", fill="darkgreen", alpha=0.5, position="identity")+theme_classic()+
  scale_x_continuous(breaks = seq(0,8000, 1000)) +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Length distribution of LGT candidates without GAGA-0200", x="Candidate length in bp", y="Number of candidates")
p0

p0 + geom_vline(aes(xintercept=mean(cand.length)), color="darkred", linetype="dashed", size=1)

#graph2png(file="LGT_length_plot")
```


```{r}
#splitted by subfamily
p1 <- ggplot(dfnoGAGA200, aes(x=cand.length, fill =subfamily, color=subfamily)) +
  geom_histogram(position="identity", alpha=0.2)+theme_classic() +
  scale_x_continuous(breaks = seq(0,8000, 1000)) +
  theme(legend.position = "top") +
  ggtitle("LGT candidate length for each ant subfamily") +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(x="Candidate length in bp", y="Number of candidates")

p1 + theme(axis.title.y = element_text(angle = 90))
p1

#graph2png(file="LGT_length_subfamily_divided")
```
